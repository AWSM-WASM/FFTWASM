{"version":3,"file":"WASMkissFFT.js","sources":["../src/index.js"],"sourcesContent":["const Module = {};\n\nconst pulse = async () => {\n  const response = await fetch('...');\n  const m = await response.arrayBuffer();\n  Module.wasmBinary = m;\n  \n  console.log(\"in buffering\");\n  const script = document.createElement('script');\n  script.src = 'src/WASMkissFFT.js'; \n  script.type='text/javascript';\n  script.onload = () => console.log(\"Loaded Emscripten.\");\n  document.body.appendChild(script); \n  \n  console.log(\"WASM loaded!\")\n  return {\n    fftComplex(size) {\n      this.size = size;\n      this.fcfg = m._kiss_fft_alloc(size, false);\n      this.icfg = m._kiss_fft_alloc(size, true);\n      \n      this.inptr = m._malloc(size*8 + size*8);\n      this.outptr = this.inptr + size*8;\n      \n      this.cin = new Float32Array(m.HEAPU8.buffer, this.inptr, size*2);\n      this.cout = new Float32Array(m.HEAPU8.buffer, this.outptr, size*2);\n      \n      this.forward = function(cin) {\n        this.cin.set(cin);\n        m._kiss_fft(this.fcfg, this.inptr, this.outptr);\n        return new Float32Array(m.HEAPU8.buffer,\n          this.outptr, this.size * 2);\n      }\n      this.inverse = function(cin) {\n        this.cin.set(cpx);\n        m._kiss_fft(this.icfg, this.inptr, this.outptr);\n        return new Float32Array(m.HEAPU8.buffer,\n          this.outptr, this.size * 2);\n      }   \n      this.dispose = function() {\n        m._free(this.inptr);\n        m._free(this.fcfg);\n        m._free(this.icfg);\n      }\n    },\n    fftReal(size) {\n      this.size = size;\n      this.fcfg = m._kiss_fftr_alloc(size, false);\n      this.icfg = m._kiss_fftr_alloc(size, true);\n      \n      this.rptr = m._malloc(size*4 + (size+2)*4);\n      this.cptr = this.rptr + size*4;\n      \n      this.ri = new Float32Array(m.HEAPU8.buffer, this.rptr, size);\n      this.ci = new Float32Array(m.HEAPU8.buffer, this.cptr, size+2);\n      \n      this.forward = function(real) {\n        this.ri.set(real);\n        m._kiss_fftr(this.fcfg, this.rptr, this.cptr);\n        return new Float32Array(m.HEAPU8.buffer, this.cptr, this.size + 2); \n      }\n      this.inverse = function(cpx) {\n        this.ci.set(cpx);\n        m._kiss_fftri(this.icfg, this.cptr, this.rptr);\n        return new Float32Array(m.HEAPU8.buffer, this.rptr, this.size);\n      }\n      this.dispose = function() {\n        m._free(this.rptr);\n        m._free(this.fcfg);\n        m._free(this.icfg);\n      }\n    }\n  };\n}\n\nexport default pulse;"],"names":["async","response","fetch","m","arrayBuffer","log","script","document","createElement","src","type","onload","console","body","appendChild","size","fcfg","_kiss_fft_alloc","icfg","inptr","_malloc","outptr","this","cin","Float32Array","HEAPU8","buffer","cout","forward","set","_kiss_fft","inverse","cpx","dispose","_free","_kiss_fftr_alloc","rptr","cptr","ri","ci","real","_kiss_fftr","_kiss_fftri"],"mappings":"wLAEcA,qBACNC,QAAiBC,MAAM,OACvBC,QAAUF,EAASG,sBAGjBC,IAAI,oBACNC,EAASC,SAASC,cAAc,mBAC/BC,IAAM,uBACNC,KAAK,oBACLC,OAAS,kBAAMC,QAAQP,IAAI,gCACzBQ,KAAKC,YAAYR,WAElBD,IAAI,qCAECU,QACJA,KAAOA,OACPC,KAAOb,EAAEc,gBAAgBF,GAAM,QAC/BG,KAAOf,EAAEc,gBAAgBF,GAAM,QAE/BI,MAAQhB,EAAEiB,QAAa,EAALL,EAAc,EAALA,QAC3BM,OAASC,KAAKH,MAAa,EAALJ,OAEtBQ,IAAM,IAAIC,aAAarB,EAAEsB,OAAOC,OAAQJ,KAAKH,MAAY,EAALJ,QACpDY,KAAO,IAAIH,aAAarB,EAAEsB,OAAOC,OAAQJ,KAAKD,OAAa,EAALN,QAEtDa,QAAU,SAASL,eACjBA,IAAIM,IAAIN,KACXO,UAAUR,KAAKN,KAAMM,KAAKH,MAAOG,KAAKD,QACjC,IAAIG,aAAarB,EAAEsB,OAAOC,OAC/BJ,KAAKD,OAAoB,EAAZC,KAAKP,YAEjBgB,QAAU,SAASR,eACjBA,IAAIM,IAAIG,OACXF,UAAUR,KAAKJ,KAAMI,KAAKH,MAAOG,KAAKD,QACjC,IAAIG,aAAarB,EAAEsB,OAAOC,OAC/BJ,KAAKD,OAAoB,EAAZC,KAAKP,YAEjBkB,QAAU,aACXC,MAAMZ,KAAKH,SACXe,MAAMZ,KAAKN,QACXkB,MAAMZ,KAAKJ,yBAGTH,QACDA,KAAOA,OACPC,KAAOb,EAAEgC,iBAAiBpB,GAAM,QAChCG,KAAOf,EAAEgC,iBAAiBpB,GAAM,QAEhCqB,KAAOjC,EAAEiB,QAAa,EAALL,EAAkB,GAARA,EAAK,SAChCsB,KAAOf,KAAKc,KAAY,EAALrB,OAEnBuB,GAAK,IAAId,aAAarB,EAAEsB,OAAOC,OAAQJ,KAAKc,KAAMrB,QAClDwB,GAAK,IAAIf,aAAarB,EAAEsB,OAAOC,OAAQJ,KAAKe,KAAMtB,EAAK,QAEvDa,QAAU,SAASY,eACjBF,GAAGT,IAAIW,KACVC,WAAWnB,KAAKN,KAAMM,KAAKc,KAAMd,KAAKe,MACjC,IAAIb,aAAarB,EAAEsB,OAAOC,OAAQJ,KAAKe,KAAMf,KAAKP,KAAO,SAE7DgB,QAAU,SAASC,eACjBO,GAAGV,IAAIG,KACVU,YAAYpB,KAAKJ,KAAMI,KAAKe,KAAMf,KAAKc,MAClC,IAAIZ,aAAarB,EAAEsB,OAAOC,OAAQJ,KAAKc,KAAMd,KAAKP,YAEtDkB,QAAU,aACXC,MAAMZ,KAAKc,QACXF,MAAMZ,KAAKN,QACXkB,MAAMZ,KAAKJ"}